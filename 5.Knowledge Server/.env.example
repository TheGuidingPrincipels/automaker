# =============================================================================
# MCP Knowledge Server Configuration
# =============================================================================
# Copy this file to .env and customize values for your environment.
# All values shown are defaults unless otherwise noted.

# -----------------------------------------------------------------------------
# Server Settings
# -----------------------------------------------------------------------------
MCP_SERVER_NAME=knowledge-server
ENV=development  # development | production
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Neo4j Database
# -----------------------------------------------------------------------------
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_secure_password_here  # REQUIRED: Change in production!
NEO4J_DATABASE=neo4j
NEO4J_MIN_POOL_SIZE=2
NEO4J_MAX_POOL_SIZE=10
NEO4J_MAX_CONNECTION_LIFETIME=3600
NEO4J_CONNECTION_TIMEOUT=30
NEO4J_MAX_TRANSACTION_RETRY_TIME=30

# -----------------------------------------------------------------------------
# ChromaDB Vector Store
# -----------------------------------------------------------------------------
CHROMA_PERSIST_DIRECTORY=./data/chroma
CHROMA_COLLECTION_NAME=concepts
CHROMA_DISTANCE_FUNCTION=cosine  # cosine | l2 | ip
# HNSW index tuning (advanced)
# CHROMA_HNSW_CONSTRUCTION_EF=128
# CHROMA_HNSW_SEARCH_EF=64
# CHROMA_HNSW_M=16

# -----------------------------------------------------------------------------
# Embedding Model
# -----------------------------------------------------------------------------
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
EMBEDDING_CACHE_DIR=./data/embeddings
EMBEDDING_DEVICE=cpu  # cpu | cuda
EMBEDDING_BATCH_SIZE=32

# -----------------------------------------------------------------------------
# Event Store
# -----------------------------------------------------------------------------
EVENT_STORE_PATH=./data/events.db

# -----------------------------------------------------------------------------
# Performance
# -----------------------------------------------------------------------------
MAX_BATCH_SIZE=50
CACHE_TTL_SECONDS=300

# -----------------------------------------------------------------------------
# Redis (for confidence scoring cache)
# -----------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # REQUIRED in production!
REDIS_SSL=false
REDIS_SSL_CERT_REQS=required
REDIS_SOCKET_TIMEOUT=5
REDIS_CONNECTION_POOL_SIZE=10

# -----------------------------------------------------------------------------
# Confidence Scoring
# -----------------------------------------------------------------------------
# Weight configuration (must sum to positive value)
CONFIDENCE_RELATIONSHIP_WEIGHT=0.40
CONFIDENCE_EXPLANATION_WEIGHT=0.30
CONFIDENCE_METADATA_WEIGHT=0.30
CONFIDENCE_UNDERSTANDING_WEIGHT=0.60
CONFIDENCE_RETENTION_WEIGHT=0.40

# Retention decay parameters
CONFIDENCE_DEFAULT_TAU_DAYS=7
CONFIDENCE_MAX_TAU_DAYS=90
CONFIDENCE_TAU_MULTIPLIER=1.5

# Cache TTL settings
CONFIDENCE_SCORE_CACHE_TTL=3600   # 1 hour
CONFIDENCE_CALC_CACHE_TTL=86400   # 24 hours

# Retry settings for pending recalculations (lock failure recovery)
CONFIDENCE_MAX_RECALC_RETRIES=5           # Max retries before dead letter escalation
CONFIDENCE_RECALC_RETRY_DELAY_SECONDS=2   # Base delay for backoff calculation
CONFIDENCE_RECALC_BATCH_SIZE=10           # Max items processed per cycle
