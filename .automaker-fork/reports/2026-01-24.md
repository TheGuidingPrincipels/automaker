# Upstream Changes Report - 2026-01-24

## Summary

- **Period**: 2026-01-23 to 2026-01-24
- **Upstream Branch**: upstream/v0.14.0rc
- **Total New Commits**: 18
- **Analyzed Commits**: 16 (after filtering CI commits)
- **Conflict Severity**: LOW

## Breaking Changes

None detected.

## New Features

| Feature                                 | Commit                                         | Files Changed | Recommendation                          |
| --------------------------------------- | ---------------------------------------------- | ------------- | --------------------------------------- |
| GitHub Copilot SDK Provider             | `0b923498`                                     | 27 files      | **Adopt** - Major provider integration  |
| Sidebar Collapsible Sections            | `f005c300`                                     | 5 files       | **Adopt** - UX enhancement              |
| Sidebar Style Options (unified/discord) | `4012a296`                                     | 6 files       | **Adopt** - UI customization            |
| Commit Step Pipeline Template           | `d8fa5c4c`                                     | 2 files       | **Adopt** - Conventional commit support |
| Splash Screen Configuration             | `bc3e3dad`                                     | 3 files       | **Adopt** - User preference             |
| Official Gemini Icon Assets             | `1430fb69`, `b34ffd95`, `ac9f33bd`, `860d6836` | 2 files       | **Adopt** - Visual polish               |

## Bug Fixes

| Fix                                       | Commit                                         | Impact                                  |
| ----------------------------------------- | ---------------------------------------------- | --------------------------------------- |
| Session usage window display              | `5281b81d`, `9e15f360`, `269b1c94`, `7bc7918c` | Usage indicator shows correct 5h window |
| Provider window limits in usage indicator | `46abd344`, `5cf817e9`, `42ee4f21`, `372cfe69` | Accurate usage tracking per provider    |

## CI Improvements

| Change                                      | Commit     |
| ------------------------------------------- | ---------- |
| Fail release when installers missing        | `51a75ae5` |
| Ensure installers uploaded as GitHub assets | `650edd69` |

## Impact on Your Modifications

### Watch Path Changes

Files in watch paths that were modified:

| Path                             | Changes                                        | Risk        |
| -------------------------------- | ---------------------------------------------- | ----------- |
| `apps/server/src/routes/setup/`  | New Copilot routes, common.ts constant         | Auto-merged |
| `apps/server/src/services/`      | auto-mode-service refactored                   | Auto-merged |
| `apps/server/src/providers/`     | New copilot-provider.ts, tool-normalization.ts | New files   |
| `apps/ui/src/store/app-store.ts` | New Copilot/sidebar state                      | Auto-merged |
| `libs/types/src/`                | New copilot-models.ts, settings changes        | Auto-merged |

### Our Fork Modifications

Our fork added `loadApiKeysFromCredentials()` to `common.ts`. Upstream added `COPILOT_DISCONNECTED_MARKER_FILE` constant. These are in different code sections and can be combined.

## Conflict Analysis

**Severity**: LOW

### Merge Simulation Result

- Clean merge possible: No (2 conflicts)
- Conflicting files: 2

### Conflicting Files

| File                                     | Watch Path? | Conflict Type                | Resolution |
| ---------------------------------------- | ----------- | ---------------------------- | ---------- |
| `apps/server/src/routes/setup/common.ts` | Yes         | Content - different sections | Easy merge |
| `package-lock.json`                      | No          | Dependency versions          | Regenerate |

### Resolution Details

**common.ts Conflict:**

- Our addition: `loadApiKeysFromCredentials()` function (lines 119-146)
- Upstream addition: `COPILOT_DISCONNECTED_MARKER_FILE` constant (lines 58-61 in upstream)
- These are at different locations - keep both

**package-lock.json Conflict:**

- Expected due to upstream adding `@github/copilot-sdk` dependency
- Resolution: Accept merge, run `npm install` to regenerate

## Resolution Strategy: Merge with Review

The conflicts are LOW severity - they're in different code sections and can be combined easily.

### Commands

```bash
# Create test worktree
git worktree add ../automaker-upstream-test -b test/upstream-merge-20260124

cd ../automaker-upstream-test

# Install dependencies
npm ci

# Merge upstream
git merge upstream/v0.14.0rc

# Resolve conflicts:
# 1. common.ts - Keep BOTH our loadApiKeysFromCredentials() AND upstream's COPILOT_DISCONNECTED_MARKER_FILE
# 2. package-lock.json - Accept either side, then regenerate

# After resolving:
git add .
git commit -m "merge: resolve upstream v0.14.0rc conflicts"

# Regenerate package-lock.json
npm install

# Verify build
npm run build:packages && npm run build:server

# Run tests
npm run test:server

# Start dev server to verify (use alternate ports)
TEST_PORT=4007 PORT=4008 npm run dev:web

# If all passes, merge to main
cd /Users/ruben/Documents/GitHub/automaker
git checkout main
git merge test/upstream-merge-20260124
git push origin main

# Cleanup
git worktree remove ../automaker-upstream-test
```

### Verification Checklist

- [ ] Build succeeds (`npm run build:packages && npm run build:server`)
- [ ] Tests pass (`npm run test:server`)
- [ ] Dev server starts (`npm run dev:web`)
- [ ] Dashboard loads at http://localhost:4007
- [ ] Settings page loads (check new Copilot tab)
- [ ] Sidebar toggle works

## Cherry-Pick Commands

If you prefer selective adoption:

```bash
# Core Copilot integration (most complex, recommend full merge instead)
git cherry-pick 0b923498

# Sidebar enhancements
git cherry-pick 4012a296  # Sidebar style options
git cherry-pick f005c300  # Collapsible sections

# Commit template
git cherry-pick d8fa5c4c

# Splash screen config
git cherry-pick bc3e3dad

# Usage indicator fixes (pick all 4)
git cherry-pick 5281b81d 9e15f360 269b1c94 7bc7918c
git cherry-pick 46abd344 5cf817e9 42ee4f21 372cfe69

# Gemini icon updates
git cherry-pick 1430fb69 b34ffd95 ac9f33bd 860d6836
```

## Recommendations

1. **Full merge recommended** - The Copilot SDK integration touches many files and cherry-picking would be fragile

2. **Test Copilot locally** - If you don't have GitHub Copilot CLI, the provider will be disabled but shouldn't break anything

3. **Sidebar style** - The new `sidebarStyle` setting defaults to 'unified' which matches current behavior

4. **New dependencies** - `@github/copilot-sdk` is added to server, may increase bundle size

## New Files Added by Upstream

```
apps/server/src/providers/copilot-provider.ts (942 lines)
apps/server/src/providers/tool-normalization.ts (112 lines)
apps/server/src/routes/setup/routes/auth-copilot.ts
apps/server/src/routes/setup/routes/copilot-models.ts
apps/server/src/routes/setup/routes/copilot-status.ts
apps/server/src/routes/setup/routes/deauth-copilot.ts
apps/server/src/services/copilot-connection-service.ts
apps/server/tests/unit/providers/copilot-provider.test.ts (517 lines)
apps/ui/src/assets/icons/gemini-icon.svg
apps/ui/src/components/views/dialogs/pipeline-step-templates/commit.ts
apps/ui/src/components/views/settings-view/cli-status/copilot-cli-status.tsx
apps/ui/src/components/views/settings-view/providers/copilot-model-configuration.tsx
apps/ui/src/components/views/settings-view/providers/copilot-settings-tab.tsx
apps/ui/src/components/views/settings-view/providers/shared/base-model-configuration.tsx
apps/ui/src/hooks/queries/use-cli-status.ts
libs/types/src/copilot-models.ts (194 lines)
docs/prd-to-features-guide.md (431 lines)
```

---

Generated by /upstream-check on 2026-01-24T11:38:00Z
Last checked commit: 7a33940816edc9ea9c7fd1b610fa1700fc19d316
New baseline commit: 900bbb5e8045d6d48e5ae8a4045dee6e4b877e26
